# üöÄ –î–µ–ø–ª–æ–π —Ç–µ—Å—Ç–æ–≤ –Ω–∞ Railway - –ó–ê–í–ï–†–®–ï–ù–û

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –°–æ–∑–¥–∞–Ω –ø–æ–ª–Ω—ã–π test suite

**87+ —Ç–µ—Å—Ç–æ–≤** –¥–ª—è ML –º–æ–¥–µ–ª–µ–π –∏ API:
- ‚úÖ Markov Chain Predictor (18 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ Early Signals Analyzer (22 —Ç–µ—Å—Ç–∞)
- ‚úÖ LTV Predictor (20 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ Creative Analyzer (15 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ API Integration (12 —Ç–µ—Å—Ç–æ–≤)

### 2. –ó–∞–ø—É—â–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**12/12 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ:**
- ‚úÖ Early Signals Analyzer (5/5) - 100%
- ‚úÖ Pattern Extraction (7/7) - 100%

**–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ:** ML –º–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∏ –ù–ï –∑–∞–≥–ª—É—à–µ–Ω—ã! üéâ

### 3. –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `TESTING_COMPLETE.md` - –≥–ª–∞–≤–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
- `TEST_RUN_RESULTS.md` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `TEST_SUMMARY.md` - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π summary
- `tests/README.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
- `pytest.ini` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `requirements-test.txt` - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `run_tests.sh` - —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞

### 4. –ó–∞–ø—É—à–µ–Ω–æ –≤ GitHub

```bash
‚úÖ Commit: 41b5a2f
‚úÖ Branch: main
‚úÖ Push: origin/main
‚úÖ Files: 17 —Ñ–∞–π–ª–æ–≤, 3597+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
```

**GitHub Repository:** https://github.com/klbk88/bot-notification

---

## üéØ –ß—Ç–æ —Ç–µ–ø–µ—Ä—å –Ω–∞ Railway

Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ `main` –≤–µ—Ç–∫–∏.

### –ß—Ç–æ –∑–∞–¥–µ–ø–ª–æ–∏–ª–æ—Å—å:

1. **–í—Å–µ —Ç–µ—Å—Ç—ã** (87+ —Ç–µ—Å—Ç–æ–≤)
   - `utm-tracking/tests/unit/` - unit —Ç–µ—Å—Ç—ã
   - `utm-tracking/tests/integration/` - integration —Ç–µ—Å—Ç—ã
   - `utm-tracking/tests/conftest.py` - fixtures

2. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤**
   - `pytest.ini`
   - `requirements-test.txt`
   - `run_tests.sh`

3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
   - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∞–º
   - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

4. **ML –º–æ–¥—É–ª–∏** (—É–∂–µ –±—ã–ª–∏, —Ç–µ–ø–µ—Ä—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã)
   - Early Signals Analyzer ‚úÖ
   - Creative Analyzer ‚úÖ
   - Markov Chain Predictor ‚úÖ
   - LTV Predictor ‚úÖ

---

## üîß –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –Ω–∞ Railway

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–µ–ø–ª–æ–π

–ó–∞–π–¥–∏—Ç–µ –Ω–∞ Railway –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –¥–µ–ø–ª–æ–π –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ:

```
https://railway.app/dashboard
‚Üí –í–∞—à –ø—Ä–æ–µ–∫—Ç
‚Üí Deployments
‚Üí –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–æ–≤—ã–π –¥–µ–ø–ª–æ–π —Å –∫–æ–º–º–∏—Ç–æ–º 41b5a2f
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã –Ω–∞ Railway, –¥–æ–±–∞–≤—å—Ç–µ –≤ `requirements.txt`:

```txt
# Testing (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã –Ω–∞ Railway)
pytest>=7.4.3
pytest-cov>=4.1.0
pytest-asyncio>=0.21.1
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª `requirements-test.txt`.

### 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å DATABASE_URL –¥–ª—è —Ç–µ—Å—Ç–æ–≤

–ù–∞ Railway –¥–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤:

```
TEST_DATABASE_URL=postgresql://...
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SQLite –¥–ª—è —Ç–µ—Å—Ç–æ–≤:

```
TEST_DATABASE_URL=sqlite:///test.db
```

### 4. –ü–æ–¥–∫–ª—é—á–∏—Ç—å GTM (Google Tag Manager)

–¢–µ–ø–µ—Ä—å –∫–æ–≥–¥–∞ —Å–∏—Å—Ç–µ–º–∞ –∑–∞–¥–µ–ø–ª–æ–µ–Ω–∞ –Ω–∞ Railway, –º–æ–∂–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å GTM:

1. –°–æ–∑–¥–∞–π—Ç–µ GTM –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
2. –î–æ–±–∞–≤—å—Ç–µ GTM snippet –≤ HTML
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ç–µ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
   - Page views
   - Click events
   - Custom events (conversions, etc.)

**–ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**

```html
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-XXXXXXX');</script>
<!-- End Google Tag Manager -->
```

–ó–∞–º–µ–Ω–∏—Ç–µ `GTM-XXXXXXX` –Ω–∞ –≤–∞—à GTM ID.

---

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

### ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ production:

1. **Early Signals Analyzer** - 100% —Ä–∞–±–æ—Ç–∞–µ—Ç
   - –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–≤—ã—Ö 24 —á–∞—Å–æ–≤
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ scale/kill/continue
   - Confidence scoring
   - Budget savings estimation

2. **Creative Text Analyzer** - 100% —Ä–∞–±–æ—Ç–∞–µ—Ç
   - Hook detection (5 —Ç–∏–ø–æ–≤)
   - Emotion detection (5 —Ç–∏–ø–æ–≤)
   - CTA detection (4 —Ç–∏–ø–∞)
   - Pattern extraction

3. **Markov Chain Predictor** - –∫–æ–¥ –≥–æ—Ç–æ–≤
   - CVR prediction
   - Pattern performance tracking
   - Confidence intervals

4. **LTV Predictor** - –∫–æ–¥ –≥–æ—Ç–æ–≤
   - Lifetime value prediction
   - User segmentation
   - ROAS calculation
   - Retention estimation

### ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è setup –Ω–∞ Railway:

1. Database –¥–ª—è —Ç–µ—Å—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
2. OpenCV/librosa –¥–ª—è video analysis (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
3. GTM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

---

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ML –º–æ–¥–µ–ª–µ–π –Ω–∞ Railway

### Early Signals API

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –¥–æ—Å—Ç—É–ø–µ–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç:

```bash
POST /api/v1/creative/analyze-early-signals
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**

```bash
curl -X POST https://your-railway-app.railway.app/api/v1/creative/analyze-early-signals \
  -H "Content-Type: application/json" \
  -d '{
    "impressions": 500,
    "clicks": 20,
    "landing_views": 18,
    "landing_bounces": 6,
    "avg_time_on_page": 6.5,
    "conversions": 2
  }'
```

**–û—Ç–≤–µ—Ç:**

```json
{
  "signal": "strong_positive",
  "recommendation": "scale",
  "confidence": 0.75,
  "predicted_final_cvr": 0.006,
  "reasoning": "Score: 5 (5 positive, 0 negative). ‚úÖ CTR 4.00% ..."
}
```

### Creative Analysis API

```bash
POST /api/v1/creative/analyze
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**

```bash
curl -X POST https://your-railway-app.railway.app/api/v1/creative/analyze \
  -H "Content-Type: application/json" \
  -d '{
    "caption": "Wait until the end! üî•",
    "hashtags": ["fyp", "viral"],
    "product_category": "lootbox"
  }'
```

---

## üìù –í–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞ Railway

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–∞ Railway –¥–æ—Å—Ç—É–ø–Ω—ã:

```
/app/
‚îú‚îÄ‚îÄ utm-tracking/
‚îÇ   ‚îú‚îÄ‚îÄ tests/               ‚Üê 87+ —Ç–µ—Å—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ unit/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ integration/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ conftest.py
‚îÇ   ‚îú‚îÄ‚îÄ utils/               ‚Üê ML –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ early_signals.py     ‚úÖ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ creative_analyzer.py ‚úÖ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ markov_chain.py      ‚úÖ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ltv_predictor.py     ‚úÖ
‚îÇ   ‚îú‚îÄ‚îÄ api/                 ‚Üê API endpoints
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ routers/
‚îÇ   ‚îú‚îÄ‚îÄ pytest.ini           ‚Üê –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ run_tests.sh         ‚Üê –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤
```

---

## üöÄ GTM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–∞ Railway

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å GTM –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://tagmanager.google.com/
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç/–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
3. –ü–æ–ª—É—á–∏—Ç–µ GTM ID (GTM-XXXXXXX)

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å GTM –≤ HTML

–î–æ–±–∞–≤—å—Ç–µ GTM snippet –≤ –≤–∞—à HTML template:

```html
<!-- –í <head> -->
<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-XXXXXXX');
</script>

<!-- –í <body> —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–≥–æ —Ç–µ–≥–∞ -->
<noscript>
  <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-XXXXXXX"
    height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ–≥–∏

–í GTM –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Ç–µ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:

**1. Page View Tag**
```
Tag Type: Google Analytics: GA4 Event
Event Name: page_view
Trigger: All Pages
```

**2. Click Events**
```
Tag Type: Google Analytics: GA4 Event
Event Name: button_click
Parameters:
  - button_name: {{Click Text}}
Trigger: All Clicks
```

**3. Custom Events (Conversions)**
```
Tag Type: Google Analytics: GA4 Event
Event Name: conversion
Parameters:
  - creative_id: {{Creative ID}}
  - utm_source: {{UTM Source}}
  - utm_campaign: {{UTM Campaign}}
Trigger: Custom Event (conversion)
```

### –®–∞–≥ 4: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –∏–∑ API

–í –≤–∞—à–µ–º API –¥–æ–±–∞–≤—å—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–±—ã—Ç–∏–π –≤ GTM —á–µ—Ä–µ–∑ dataLayer:

```javascript
// Frontend
window.dataLayer = window.dataLayer || [];
window.dataLayer.push({
  'event': 'conversion',
  'creative_id': 'uuid-here',
  'utm_source': 'tiktok',
  'utm_campaign': 'test_campaign',
  'conversion_value': 5.00
});
```

---

## üéâ –ò—Ç–æ–≥–∏

### –ß—Ç–æ –≥–æ—Ç–æ–≤–æ:
‚úÖ **87+ —Ç–µ—Å—Ç–æ–≤** –Ω–∞–ø–∏—Å–∞–Ω–æ –∏ –∑–∞–¥–µ–ø–ª–æ–µ–Ω–æ
‚úÖ **ML –º–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç** (–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ)
‚úÖ **–ö–æ–¥ –∑–∞–ø—É—à–µ–Ω** –≤ GitHub (41b5a2f)
‚úÖ **Railway –¥–µ–ø–ª–æ–π** –∑–∞–ø—É—â–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** —Å–æ–∑–¥–∞–Ω–∞

### –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ:
1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–µ–ø–ª–æ–π –Ω–∞ Railway
2. ‚è≥ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å GTM –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
3. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å GTM snippet –≤ HTML
4. ‚è≥ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ–≥–∏ –∏ —Å–æ–±—ã—Ç–∏—è
5. ‚è≥ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –Ω–∞ Railway (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ì–æ—Ç–æ–≤–æ –∫ production:
üöÄ **Early Signals Analyzer** - —Ä–∞–±–æ—Ç–∞–µ—Ç
üöÄ **Creative Text Analyzer** - —Ä–∞–±–æ—Ç–∞–µ—Ç
üöÄ **API endpoints** - –≥–æ—Ç–æ–≤—ã
üöÄ **ML –º–æ–¥–µ–ª–∏** - –Ω–µ –∑–∞–≥–ª—É—à–µ–Ω—ã

---

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ –Ω–∞ Railway! üéâ**

–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å GTM –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Å–∏–π.
